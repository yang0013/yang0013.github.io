<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>ARTS w01 | Yang</title>
<meta name="generator" content="Jekyll v3.8.3" />
<meta property="og:title" content="ARTS w01" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Algorithm leetcode 29 题，Divide Two Integers ，给两个整数：除数和被除数，要求不使用乘法、除法、取余，计算两个数的商。 例子：" />
<meta property="og:description" content="Algorithm leetcode 29 题，Divide Two Integers ，给两个整数：除数和被除数，要求不使用乘法、除法、取余，计算两个数的商。 例子：" />
<link rel="canonical" href="/arts/2018/08/11/ARTS-w01.html" />
<meta property="og:url" content="/arts/2018/08/11/ARTS-w01.html" />
<meta property="og:site_name" content="Yang" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-08-11T11:34:14+08:00" />
<script type="application/ld+json">
{"description":"Algorithm leetcode 29 题，Divide Two Integers ，给两个整数：除数和被除数，要求不使用乘法、除法、取余，计算两个数的商。 例子：","@type":"BlogPosting","url":"/arts/2018/08/11/ARTS-w01.html","headline":"ARTS w01","dateModified":"2018-08-11T11:34:14+08:00","datePublished":"2018-08-11T11:34:14+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"/arts/2018/08/11/ARTS-w01.html"},"@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Yang" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Yang</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">ARTS w01</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2018-08-11T11:34:14+08:00" itemprop="datePublished">Aug 11, 2018
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="algorithm">Algorithm</h2>
<p>leetcode 29 题，<a href="https://leetcode.com/submissions/detail/168774665/">Divide Two Integers </a>，给两个整数：除数和被除数，要求不使用乘法、除法、取余，计算两个数的商。<br />
例子：</p>

<blockquote>
  <p>Input: dividend = 10, divisor = 3<br />
Output: 3</p>
</blockquote>

<p>代码：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">divide</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">):</span>
    <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">tmp</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">dividend</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">tmp</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">=</span><span class="n">tmp</span><span class="o">&gt;&gt;</span><span class="mi">1</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        
    <span class="n">highest_bit</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>
    
    <span class="n">y</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">divisor</span><span class="p">)</span>
    <span class="n">x</span><span class="o">=</span><span class="nb">abs</span><span class="p">(</span><span class="n">dividend</span><span class="p">)</span>
    <span class="n">j</span><span class="o">=</span><span class="n">highest_bit</span>
    <span class="n">res</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">allf</span> <span class="o">=</span> <span class="mh">0xFFFFFFFF</span>
    <span class="k">while</span> <span class="n">x</span><span class="o">&gt;</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">j</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>        
        <span class="n">tmp</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">allf</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="n">j</span>

        <span class="k">if</span> <span class="n">tmp</span> <span class="o">-</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">=</span> <span class="p">((</span><span class="n">tmp</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">allf</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="mi">32</span><span class="o">-</span><span class="n">j</span><span class="p">)))</span>
            <span class="n">res</span><span class="o">=</span> <span class="n">res</span><span class="o">+</span><span class="p">(</span><span class="mi">1</span><span class="o">&lt;&lt;</span><span class="n">j</span><span class="p">)</span>
<span class="c">#            print('res', res)</span>
        <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="n">negative</span> <span class="o">=</span> <span class="p">((</span><span class="n">dividend</span> <span class="o">^</span> <span class="n">divisor</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="mi">31</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span>
    <span class="n">res</span> <span class="o">=</span> <span class="o">-</span><span class="n">res</span> <span class="k">if</span> <span class="n">negative</span> <span class="k">else</span> <span class="n">res</span>
    <span class="n">max_sign_int</span> <span class="o">=</span> <span class="n">allf</span><span class="o">&gt;&gt;</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">&gt;</span><span class="n">max_sign_int</span> <span class="ow">or</span> <span class="n">res</span><span class="o">&lt;-</span><span class="n">max_sign_int</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">max_sign_int</span>

    <span class="k">return</span> <span class="n">res</span>
</code></pre></div></div>

<p>这道题花了四个多小时，解题思路：使用位移操作，从 dividend 的高位开始，减去除数 divisor。但过程比较复杂，容易出错，计算了半天。</p>

<p>翻了其他人的代码，有一个比较简洁：</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">divide_e</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dividend</span><span class="p">,</span> <span class="n">divisor</span><span class="p">):</span>     
    <span class="n">neg</span><span class="o">=</span><span class="p">(</span> <span class="p">(</span><span class="n">dividend</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="n">divisor</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">dividend</span> <span class="o">=</span> <span class="n">left</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dividend</span><span class="p">)</span>
    <span class="n">divisor</span>  <span class="o">=</span> <span class="n">div</span>  <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">divisor</span><span class="p">)</span>
    <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">left</span> <span class="o">&gt;=</span> <span class="n">divisor</span><span class="p">:</span>
        <span class="n">left</span> <span class="o">-=</span> <span class="n">div</span>
        <span class="n">ans</span>  <span class="o">+=</span> <span class="n">Q</span> 
        <span class="n">Q</span>    <span class="o">+=</span> <span class="n">Q</span>
        <span class="n">div</span>  <span class="o">+=</span> <span class="n">div</span>
        <span class="k">print</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">ans</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">div</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">left</span> <span class="o">&lt;</span> <span class="n">div</span><span class="p">:</span>
            <span class="n">div</span> <span class="o">=</span> <span class="n">divisor</span>
            <span class="k">print</span><span class="p">(</span><span class="s">'reset'</span><span class="p">,</span> <span class="n">div</span><span class="p">)</span>
            <span class="n">Q</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">neg</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">ans</span><span class="p">,</span> <span class="o">-</span><span class="mi">2147483648</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">ans</span><span class="p">,</span> <span class="mi">2147483647</span><span class="p">)</span>
</code></pre></div></div>
<p>这个逻辑清晰，代码简洁。dividend 不断减去 divisor 的 1、2、3……倍，不够减时再重置 divisor，直到 dividend 小于最初的 divisor。</p>

<h2 id="review">Review</h2>

<p>medium 的一篇文章 <a href="https://medium.com/@mycoralhealth/code-your-own-proof-of-stake-blockchain-in-go-610cd99aa658">Code your own Proof of Stake blockchain in Go!</a>，用 go 语言实现一个简单的 PoS（Proof of Stake）。最近看了很多以太坊 casper 的资料，casper 也是权益证明，看的云里雾里。这篇文章却给我提供了一个新的思路，一个简单可运行的PoS版本，理解 PoS 的核心。</p>

<p>文章首先介绍了什么是 PoS，然后是 PoS 的弊端，然后就开始编码实现一条 PoS 区块链了！主要实现了两个功能，1. 伪点对点网络，节点之间的通讯通过一个中心的 TCP Server。2. 钱包和余额追踪。这两个功能就可以启动一条链。用一张图介绍了代码的结构，很直观。接着就是手把手教你写代码了。这是我很喜欢读英文技术文章的原因，他们会把思考的过程都梳理出来，让你清楚的知道全部的逻辑，以及为什么要这么做。他们基本都会从最简单的开始，如果没有也会给你相关链接，告诉你要先了解哪些信息，非常友好的技术文章。</p>

<h2 id="tip">Tip</h2>
<p>从上面的文章，学了一个小技巧，使用命令<code class="highlighter-rouge">nc</code> 和 TCP Server 交互通讯，很方便。文章中的例子：</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt; nc localhost 9090
Enter token balance:100

Enter a new BPM:1

Enter a new BPM:2

Enter a new BPM:3

ca548b272862d4b4ed497bda28560fe7e1624b9d8b8cee18e50731f6d4ba74d1 赢得了记账权利
</code></pre></div></div>

<h2 id="share">Share</h2>

<p>最近看 bancor 的一些资料，分享一篇文章 <a href="http://hackingdistributed.com/2017/06/19/bancor-is-flawed/">Bancor Is Flawed</a>，作者指责 bancor 团队用几行代码筹集了 1444 万美元，并细数了 bancor 的十八条罪状，如 bancor 的存在没意义、代码糟糕。评论区值得看，有几个大神为 bancor 辩护， bancor 团队针对每一条都做了详细的回复，<a href="https://blog.bancor.network/this-analysis-of-bancor-is-flawed-18ab8a000d43">Response to “Bancor is Flawed”
</a>。看他们如何去辩论，了解不同的观点，能够帮助思考 bancor 的应用，bancor 并不大适合用来做 Token 之间转换的交易，这个另外写一篇，好好梳理下。</p>

  </div><a class="u-url" href="/arts/2018/08/11/ARTS-w01.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <!-- <h2 class="footer-heading">Yang</h2> -->

    <div class="footer-col-wrapper">
     <!--  <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Yang</li></ul>
      </div> -->

      <div class="footer-col"><ul class="social-media-list"><li><a href="https://github.com/yang0013"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">yang0013</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
